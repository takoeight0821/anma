(type (var Int) (prim int))
(type (call (var List) (var a)) (call (var Nil)) (call (var Cons) (var a) (var List)))
(infix infixl 6 -)
(def - (lambda (x0 x1) (case ((var x0) (var x1)) (clause ((var x) (var y)) (seq (prim sub (var x) (var y)))))))
(def map (lambda (x0 x1) (case ((var x0) (var x1)) (clause ((var f) (call (var Nil))) (seq (call (var Nil)))) (clause ((var f) (call (var Cons) (var x) (var xs))) (seq (call (var Cons) (call (var f) (var x)) (call (var map) (var f) (var xs))))))))
(def prune (lambda (x0 x1) (object (field children (case ((var x0) (var x1)) (clause ((literal 0) (var t)) (seq (var Nil))) (clause ((var x) (var t)) (seq (call (var map) (call (var prune) (binary (var x) - (literal 1))) (access (var t) children)))))) (field node (case ((var x0) (var x1)) (clause ((var x) (var t)) (seq (access (var t) node))))))))
(def tree (object (field children (seq (call (var Cons) (var tree1) (call (var Cons) (var tree2) (call (var Nil)))))) (field node (seq (literal 1)))))
(def tree1 (object (field children (seq (call (var Nil)))) (field node (seq (literal 2)))))
(def tree2 (object (field children (seq (call (var Cons) (var tree) (call (var Nil))))) (field node (seq (literal 3)))))
(def main (lambda () (seq (call (var prune) (literal 2) (var tree)))))
